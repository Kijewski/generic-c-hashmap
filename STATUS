Did not run it once.
It compiles.

I hacked this for fun.
I don't think it is free of bugs or severe logic faults! ;)
